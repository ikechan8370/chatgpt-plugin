import{p as ie,n as pe,o as w,B as b,am as ve,ao as ge,ac as fe,D as e,a2 as O,J as T,K as Q,O as p,aR as _e,Q as D,R as S,S as o,$ as W,a0 as C,_ as y,a4 as i,a5 as N,aH as $,aI as x,H as V,F as K,aD as be,P,bw as Ve,U as B,aF as Ae,W as De,aV as Pe,T as R,bx as he,by as ke,a6 as Se,a1 as Te,a3 as xe,bz as Ce,bA as ye}from"./index.86ff0207.js";import{m as Be,a as Re,b as we,c as Ne,d as $e,e as Ke,f as Ie,u as Ee,p as Fe,g as Ge,h as He,i as Le,j as Ue,k as qe,l as Oe,V as H,n as L,o as U}from"./VDataTable.dfa329b9.js";import{V as q}from"./VTable.1418a69d.js";import{V as Qe}from"./VDialog.5ca391ab.js";import{V as We}from"./VTextarea.58b6c495.js";import"./VSelect.f389ef7d.js";import"./VCheckboxBtn.80f1dc55.js";const je=ie({itemsLength:{type:[Number,String],required:!0},...Be(),...Re(),...we()},"VDataTableServer"),ze=pe()({name:"VDataTableServer",props:je(),emits:{"update:modelValue":s=>!0,"update:page":s=>!0,"update:itemsPerPage":s=>!0,"update:sortBy":s=>!0,"update:options":s=>!0,"update:expanded":s=>!0,"update:groupBy":s=>!0,"click:row":(s,r)=>!0},setup(s,r){let{emit:A,slots:a}=r;const{groupBy:u}=Ne(s),{sortBy:d,multiSort:c,mustSort:m}=$e(s),{page:v,itemsPerPage:_}=Ke(s),g=w(()=>parseInt(s.itemsLength,10)),{columns:n,headers:t}=Ie(s,{groupBy:u,showSelect:b(s,"showSelect"),showExpand:b(s,"showExpand")}),{items:l}=Ee(s,n),{toggleSort:h}=Fe({sortBy:d,multiSort:c,mustSort:m,page:v}),{opened:j,isGroupOpen:z,toggleGroup:J,extractRows:M}=Ge({groupBy:u,sortBy:d}),{pageCount:X,setItemsPerPage:Y}=He({page:v,itemsPerPage:_,itemsLength:g}),{flatItems:I}=Le(l,u,j),{isSelected:Z,select:ee,selectAll:ae,toggleSelect:te,someSelected:le,allSelected:oe}=Ue(s,{allItems:l,currentPage:l}),{isExpanded:se,toggleExpand:re}=qe(s),ne=w(()=>M(l.value));Oe({page:v,itemsPerPage:_,sortBy:d,groupBy:u,search:b(s,"search")}),ve("v-data-table",{toggleSort:h,sortBy:d}),ge({VDataTableRows:{hideNoData:b(s,"hideNoData"),noDataText:b(s,"noDataText"),loading:b(s,"loading"),loadingText:b(s,"loadingText")}});const f=w(()=>({page:v.value,itemsPerPage:_.value,sortBy:d.value,pageCount:X.value,toggleSort:h,setItemsPerPage:Y,someSelected:le.value,allSelected:oe.value,isSelected:Z,select:ee,selectAll:ae,toggleSelect:te,isExpanded:se,toggleExpand:re,isGroupOpen:z,toggleGroup:J,items:ne.value,groupedItems:I.value,columns:n.value,headers:t.value}));fe(()=>{const[ue]=H.filterProps(s),[de]=L.filterProps(s),[ce]=U.filterProps(s),[me]=q.filterProps(s);return e(q,T({class:["v-data-table",{"v-data-table--loading":s.loading},s.class],style:s.style},me),{top:()=>{var k;return(k=a.top)==null?void 0:k.call(a,f.value)},default:()=>{var k,E,F,G;return a.default?a.default(f.value):e(O,null,[(k=a.colgroup)==null?void 0:k.call(a,f.value),e("thead",{class:"v-data-table__thead",role:"rowgroup"},[e(L,T(de,{sticky:s.fixedHeader}),a)]),(E=a.thead)==null?void 0:E.call(a,f.value),e("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[a.body?a.body(f.value):e(U,T(ce,{items:I.value}),a)]),(F=a.tbody)==null?void 0:F.call(a,f.value),(G=a.tfoot)==null?void 0:G.call(a,f.value)])},bottom:()=>a.bottom?a.bottom(f.value):e(H,ue,{prepend:a["footer.prepend"]})})})}}),Je=["colspan"],Me={__name:"PromptList",setup(s){const r=Q(),A=[{title:"\u8BBE\u5B9A\u540D\u79F0",key:"title",sortable:!1},{title:"\u4E0A\u4F20\u8005QQ",key:"qq",sortable:!1},{title:"\u4E0A\u4F20\u65F6\u95F4",key:"createTime",sortable:!1},{title:"\u662F\u5426R18",key:"r18",sortable:!1},{title:"\u4F7F\u7528\u573A\u666F",key:"use",sortable:!1},{title:"",key:"data-table-expand",sortable:!1}],a=p([]),u=p(),d=p(0),c=p(),m=p();_e([c],()=>{m.value=String(Date.now())});const v=({page:g,itemsPerPage:n,sortBy:t})=>{u.value=!0,P.get("/prompt/prompt/list",{params:{search:c.value,page:g-1||0},headers:{"FROM-CHATGPT":"ikechan8370"}}).then(l=>{u.value=!1,l.data?(a.value=l.data.data.content,d.value=l.data.data.totalElements):r.commit("app/ADD_SNACKBAR",{message:"\u8BBE\u5B9A\u670D\u52A1\u5668\u5F02\u5E38",color:"warn"})}).catch(l=>{u.value=!1,r.commit("app/ADD_SNACKBAR",{message:l.message,color:"error"}),console.log(l)})},_=(g,n)=>{u.value=!0,P.post(`${r.getters.serverApi}addPrompt`,{token:r.getters.userToken,prompt:g,content:n}).then(t=>{u.value=!1,t.data&&t.data.state?r.commit("app/ADD_SNACKBAR",{message:"\u6DFB\u52A0\u6210\u529F",color:"success"}):r.commit("app/ADD_SNACKBAR",{message:"\u6DFB\u52A0\u5931\u8D25",color:"error"})}).catch(t=>{u.value=!1,r.commit("app/ADD_SNACKBAR",{message:t.message,color:"error"}),console.log(t)})};return(g,n)=>(D(),S(be(ze),{search:m.value,headers:A,"items-length":d.value,items:a.value,loading:u.value,"items-per-page":"10",class:"elevation-1","item-value":"title","onUpdate:options":v},{top:o(()=>[e(W,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=t=>c.value=t),"hide-details":"",label:"\u641C\u7D22\u8BBE\u5B9A",placeholder:"\u8BBE\u5B9A\u540D...",class:"ma-2",density:"compact"},null,8,["modelValue"])]),"expanded-row":o(({columns:t,item:l})=>[C("tr",null,[C("td",{colspan:t.length},[e(y,{"no-gutters":""},{default:o(()=>[i(N(l.raw.prompt),1)]),_:2},1024),e($,null,{default:o(()=>[e(x),e(V,{variant:"text",color:"primary",onClick:h=>_(l.raw.title,l.raw.prompt)},{default:o(()=>[i(" \u4E0B\u8F7D\u8BBE\u5B9A ")]),_:2},1032,["onClick"])]),_:2},1024)],8,Je)])]),"item.r18":o(({item:t})=>[e(K,null,{default:o(()=>[i(N(t.columns.r18?"ep:warn-triangle-filled":""),1)]),_:2},1024)]),_:1},8,["search","items-length","items","loading"]))}},Xe=C("span",{class:"text-h5"},"\u6DFB\u52A0\u8BBE\u5B9A",-1),Ye=C("small",null,"*\u91CD\u540D\u8BBE\u5B9A\u5C06\u4F1A\u88AB\u66FF\u6362",-1),Ze={__name:"Prompts",setup(s){const r=Q(),A=p([]),a=p(),u=p(),d=p(),c=p(),m=()=>{a.value=!0,P.post(`${r.getters.serverApi}getPromptList`,{token:r.getters.userToken}).then(n=>{a.value=!1,n.data?A.value=n.data:r.commit("app/ADD_SNACKBAR",{message:"\u8BBE\u5B9A\u5217\u8868\u83B7\u53D6\u5931\u8D25",color:"error"})}).catch(n=>{a.value=!1,r.commit("app/ADD_SNACKBAR",{message:n.message,color:"error"}),console.log(n)})},v=(n,t)=>{a.value=!0,P.post(`${r.getters.serverApi}addPrompt`,{token:r.getters.userToken,prompt:n,content:t}).then(l=>{a.value=!1,l.data&&l.data.state?m():r.commit("app/ADD_SNACKBAR",{message:"\u6DFB\u52A0\u5931\u8D25",color:"error"})}).catch(l=>{a.value=!1,r.commit("app/ADD_SNACKBAR",{message:l.message,color:"error"}),console.log(l)})},_=n=>{a.value=!0,P.post(`${r.getters.serverApi}deletePrompt`,{token:r.getters.userToken,prompt:n}).then(t=>{a.value=!1,t.data&&t.data.state?m():r.commit("app/ADD_SNACKBAR",{message:"\u5220\u9664\u5931\u8D25",color:"error"})}).catch(t=>{a.value=!1,r.commit("app/ADD_SNACKBAR",{message:t.message,color:"error"}),console.log(t)})},g=n=>{a.value=!0,P.post(`${r.getters.serverApi}usePrompt`,{token:r.getters.userToken,prompt:n}).then(t=>{var l;a.value=!1,t.data&&t.data.state?m():r.commit("app/ADD_SNACKBAR",{message:`\u8BBE\u5B9A\u5931\u8D25 ${(l=t.data)==null?void 0:l.error}`,color:"error"})}).catch(t=>{a.value=!1,r.commit("app/ADD_SNACKBAR",{message:t.message,color:"error"}),console.log(t)})};return m(),(n,t)=>(D(),S(B,null,{default:o(()=>[e(Ve,{collapse:"",density:"compact"},{default:o(()=>[e(V,{icon:"",onClick:m},{default:o(()=>[e(K,null,{default:o(()=>[i("mdi-restore")]),_:1})]),_:1}),e(Qe,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=l=>u.value=l),persistent:""},{activator:o(({props:l})=>[e(V,T({icon:""},l),{default:o(()=>[e(K,null,{default:o(()=>[i("mdi-add")]),_:1})]),_:2},1040)]),default:o(()=>[e(B,null,{default:o(()=>[e(Ae,null,{default:o(()=>[Xe]),_:1}),e(De,null,{default:o(()=>[e(Pe,null,{default:o(()=>[e(y,null,{default:o(()=>[e(R,{cols:"12"},{default:o(()=>[e(W,{label:"\u8BBE\u5B9A\u540D\u79F0",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l),required:""},null,8,["modelValue"])]),_:1}),e(R,{cols:"12"},{default:o(()=>[e(We,{label:"\u8BBE\u5B9A\u5185\u5BB9",modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=l=>c.value=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),Ye]),_:1}),e($,null,{default:o(()=>[e(x),e(V,{color:"blue-darken-1",variant:"text",onClick:t[2]||(t[2]=l=>u.value=!1)},{default:o(()=>[i(" \u5173\u95ED ")]),_:1}),e(V,{color:"blue-darken-1",variant:"text",onClick:t[3]||(t[3]=l=>{u.value=!1,v(d.value,c.value)})},{default:o(()=>[i(" \u6DFB\u52A0 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(he,null,{default:o(()=>[a.value?(D(),S(ke,{key:0,color:"deep-purple-accent-4",indeterminate:"",rounded:""})):Se("",!0),(D(!0),Te(O,null,xe(A.value,l=>(D(),S(Ce,{key:l.name,title:l.name},{default:o(()=>[e(ye,null,{default:o(()=>[e(y,{"no-gutters":""},{default:o(()=>[e(x),i(" "+N(l.content),1)]),_:2},1024),e($,null,{default:o(()=>[e(x),e(V,{variant:"text",color:"error",onClick:h=>_(l.name)},{default:o(()=>[i(" \u5220\u9664\u8BBE\u5B9A ")]),_:2},1032,["onClick"]),e(V,{variant:"text",color:"primary",onClick:h=>g(l.name)},{default:o(()=>[i(" \u5E94\u7528\u8BBE\u5B9A ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1})]),_:1}))}},na={__name:"prompt",setup(s){return(r,A)=>(D(),S(y,null,{default:o(()=>[e(R,{cols:"12"},{default:o(()=>[e(B,{title:"\u5728\u7EBF\u8BBE\u5B9A\u5217\u8868"},{default:o(()=>[e(Me)]),_:1})]),_:1}),e(R,{cols:"12"},{default:o(()=>[e(B,{title:"\u672C\u5730\u8BBE\u5B9A\u5217\u8868"},{default:o(()=>[e(Ze)]),_:1})]),_:1})]),_:1}))}};export{na as default};
